<div class="inventory-admin-page">
  <section class="hero-card">
    <div class="hero-content">
      <p class="eyebrow">Panel exclusivo para Administradores</p>
      <h1>Gesti√≥n estrat√©gica de inventario</h1>
      <p class="subtitle">
        Supervisa existencias, identifica alertas en tiempo real y mant√©n el flujo perfecto entre cocina y proveedores.
      </p>
      <div class="hero-actions">
        <button class="primary" (click)="goToCreate()">
          <span>+ Crear Inventario</span>
          <small>Nuevo registro inmediato</small>
        </button>
        <button class="ghost" (click)="refreshData()">
          <span>Actualizar datos</span>
        </button>
      </div>
    </div>
    <div class="hero-image">
      <img src="https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=1200&q=80" alt="Inventario gourmet" />
      <div class="image-overlay">
        <div class="overlay-card">
          <p>√çtems cr√≠ticos</p>
          <strong>{{ stats.critical }}</strong>
          <span>Prioriza resurtidos</span>
        </div>
        <div class="overlay-card">
          <p>Stock total</p>
          <strong>{{ stats.totalUnits | number:'1.0-0' }}</strong>
          <span>Unidades disponibles</span>
        </div>
      </div>
    </div>
  </section>

  <section class="inventory-layout">
    <div class="inventory-panel">
      <header class="panel-header">
        <div class="search-group">
          <input
            type="text"
            placeholder="Buscar por ingrediente o restaurante..."
            [(ngModel)]="searchTerm"
            (ngModelChange)="onFiltersChange()"
          />
          <span class="search-icon">üîç</span>
        </div>
        <div class="filters">
          <select [(ngModel)]="restaurantFilter" (change)="onFiltersChange()">
            <option value="all">Todas las sedes</option>
            <option *ngFor="let restaurant of restaurants" [value]="restaurant.id">
              {{ restaurant.name }}
            </option>
          </select>
          <select [(ngModel)]="statusFilter" (change)="onFiltersChange()">
            <option value="all">Todos los estados</option>
            <option value="available">Disponible</option>
            <option value="low">Cr√≠tico</option>
            <option value="out">Agotado</option>
          </select>
          <button class="primary ghosty" (click)="goToCreate()">+ Crear Inventario</button>
        </div>
      </header>

      <div class="table-wrapper" *ngIf="filteredItems.length; else emptyState">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Restaurante</th>
              <th>Ingrediente</th>
              <th>Cantidad</th>
              <th>Unidad</th>
              <th>Estado</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="let item of filteredItems; trackBy: trackById"
              (click)="selectItem(item)"
              [class.selected]="selectedItem?.id === item.id"
            >
              <td>
                <div class="item-info">
                  <div class="avatar">{{ (item.ingredientName || item.id).charAt(0) }}</div>
                  <div>
                    <strong>{{ item.id }}</strong>
                  </div>
                </div>
              </td>
              <td>
                <strong>{{ item.restaurantName || 'N/A' }}</strong>
              </td>
              <td>
                <div class="ingredient-chip">
                  <span>{{ item.ingredientName || 'N/A' }}</span>
                  <small>{{ item.unitCode || '' }}</small>
                </div>
              </td>
              <td>
                <div class="quantity">
                  <strong>{{ item.quantity }}</strong>
                  <div class="progress-bar">
                    <div class="progress" [style.width.%]="getStockProgress(item)"></div>
                  </div>
                </div>
              </td>
              <td>{{ item.unitCode || 'N/A' }}</td>
              <td>
                <span class="status-chip" [ngClass]="item.status || 'available'">
                  {{ getStatusLabel(item.status) }}
                </span>
              </td>
              <td class="actions">
                <button class="ghost" (click)="editItem(item, $event)">Editar</button>
                <button class="danger ghost" (click)="deleteItem(item, $event)">Eliminar</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <ng-template #emptyState>
        <div class="empty-state">
          <h3>Sin resultados</h3>
          <p>Prueba con otro t√©rmino.</p>
        </div>
      </ng-template>
    </div>

    <aside class="insights-panel">
      <div class="detail-card" *ngIf="selectedItem as item; else placeholderCard">
        <div class="detail-cover">
          <img src="https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=900&q=80" alt="Inventario" />
          <span class="status-pill" [ngClass]="item.status || 'available'">{{ getStatusLabel(item.status) }}</span>
        </div>
        <div class="detail-body">
          <p class="eyebrow">Detalle inteligente</p>
          <h2>{{ item.ingredientName || item.id }}</h2>
          <div class="detail-grid">
            <div>
              <label>Stock actual</label>
              <strong>{{ item.quantity }} {{ item.unitCode || '' }}</strong>
            </div>
            <div>
              <label>Ingrediente</label>
              <strong>{{ item.ingredientName || 'Sin ingrediente' }}</strong>
            </div>
            <div>
              <label>Sede</label>
              <strong>{{ item.restaurantName || 'Sin restaurante' }}</strong>
            </div>
            <div>
              <label>Unidad</label>
              <strong>{{ item.unitCode || 'Sin unidad' }}</strong>
            </div>
          </div>
        </div>
      </div>
      <ng-template #placeholderCard>
        <div class="detail-card placeholder">
          <h3>Selecciona un art√≠culo</h3>
          <p>Ver√°s m√©tricas precisas y recomendaciones inteligentes.</p>
        </div>
      </ng-template>

      <div class="timeline-card">
        <p class="eyebrow">Movimiento reciente</p>
        <h3>√öltimas actualizaciones</h3>
        <ul>
          <li *ngFor="let item of recentItems">
            <div>
              <strong>{{ item.ingredientName || item.id }}</strong>
              <p>{{ item.restaurantName || 'N/A' }}</p>
            </div>
          </li>
        </ul>
      </div>
    </aside>
  </section>
</div>
