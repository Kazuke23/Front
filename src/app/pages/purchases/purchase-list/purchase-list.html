<div class="purchase-list-page">
  <div class="page-header">
    <h1>GestiÃ³n de Compras</h1>
    <p class="description">Supervise y administre todos los pedidos de compra, los proveedores y el estado de entrega en un solo lugar.</p>
  </div>

  <div class="action-bar">
    <div class="search-container">
      <div class="search-group">
        <input
          type="text"
          placeholder="Buscar pedidos..."
          [(ngModel)]="searchTerm"
          (ngModelChange)="onFiltersChange()"
        />
        <span class="search-icon">ğŸ”</span>
      </div>
    </div>
    <button class="create-btn" (click)="goToCreate()">Crear Compra</button>
  </div>

  <div class="table-section">
    <div class="table-wrapper" *ngIf="filteredOrders.length; else emptyState">
      <table>
        <thead>
          <tr>
            <th>ID de Pedido</th>
            <th>Fecha de Pedido</th>
            <th>Proveedor</th>
            <th>Monto Total</th>
            <th>Estado</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr
            *ngFor="let order of getPaginatedOrders(); trackBy: trackById; let even = even; let odd = odd"
            [class.even]="even"
            [class.odd]="odd"
          >
            <td>
              <strong>{{ order.id }}</strong>
            </td>
            <td>
              <span class="date-value">{{ getOrderDate(order) }}</span>
            </td>
            <td>
              <strong>{{ order.supplierName || 'N/A' }}</strong>
            </td>
            <td>
              <strong class="amount">${{ (order.totalAmount || 0) | number:'1.2-2' }}</strong>
            </td>
            <td>
              <span class="status-chip" [ngClass]="getStatusClass(order.status)">
                {{ getStatusLabel(order.status) }}
              </span>
            </td>
            <td class="actions">
              <button class="action-btn" (click)="editOrder(order, $event)" title="Ver">ğŸ‘ï¸</button>
              <button class="action-btn" (click)="editOrder(order, $event)" title="Editar">âœï¸</button>
            </td>
          </tr>
        </tbody>
      </table>
      <div class="pagination" *ngIf="getTotalPages() > 1">
        <button class="page-btn" (click)="goToPage(currentPage - 1)" [disabled]="currentPage === 1">Previous</button>
        <div class="page-numbers">
          <button
            *ngFor="let page of [].constructor(getTotalPages()); let i = index"
            class="page-btn"
            [class.active]="currentPage === i + 1"
            (click)="goToPage(i + 1)"
          >
            {{ i + 1 }}
          </button>
        </div>
        <button class="page-btn" (click)="goToPage(currentPage + 1)" [disabled]="currentPage === getTotalPages()">Next</button>
      </div>
    </div>
    <ng-template #emptyState>
      <div class="empty-state">
        <h3>Sin resultados</h3>
        <p>Prueba con otro tÃ©rmino o crea un nuevo pedido.</p>
        <button class="create-btn" (click)="goToCreate()">Crear nuevo pedido</button>
      </div>
    </ng-template>
  </div>
</div>
